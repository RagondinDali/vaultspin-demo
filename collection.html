<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>VaultSpin – Ma collection (Locale)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }
      body {
        min-height: 100vh;
        background: radial-gradient(circle at top, #101827, #020617 60%);
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        color: #e5e7eb;
      }

      .wrap { max-width: 1100px; margin: 0 auto; padding: 26px 16px 42px; }

      .top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 14px;
      }

      h1 {
        font-size: 18px;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: #f9fafb;
      }

      .btn {
        border-radius: 999px;
        padding: 10px 14px;
        font-size: 12px;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        border: 0;
        cursor: pointer;
        color: #fff;
        background: radial-gradient(circle at top left, #a855f7, #4f46e5);
        box-shadow: 0 0 14px rgba(168, 85, 247, 0.35);
      }
      .btn.secondary {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(148, 163, 184, 0.35);
        box-shadow: none;
      }

      .meta {
        margin-top: 6px;
        font-size: 12px;
        color: #9ca3af;
      }

      .grid {
        margin-top: 18px;
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 14px;
      }
      @media (max-width: 1000px) { .grid { grid-template-columns: repeat(4, 1fr); } }
      @media (max-width: 720px) { .grid { grid-template-columns: repeat(2, 1fr); } }

      .card {
        border-radius: 18px;
        border: 1px solid rgba(148, 163, 184, 0.22);
        background: rgba(15, 23, 42, 0.55);
        padding: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .thumb {
        width: 100%;
        aspect-ratio: 3 / 4;
        border-radius: 14px;
        overflow: hidden;
        border: 1px solid rgba(148, 163, 184, 0.25);
        background: rgba(2, 6, 23, 0.55);
      }
      .thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }

      .row { display: flex; justify-content: space-between; gap: 10px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.12em; }
      .id { opacity: 0.85; }
      .rar.common { color: #facc15; font-weight: 800; }
      .rar.rare { color: #38bdf8; font-weight: 800; }
      .rar.ultra { color: #a855f7; font-weight: 800; }
      .rar.legendary { color: #f97316; font-weight: 800; }

      .empty {
        margin-top: 18px;
        border-radius: 18px;
        border: 1px dashed rgba(148, 163, 184, 0.35);
        background: rgba(2, 6, 23, 0.35);
        padding: 18px;
        color: #9ca3af;
        font-size: 13px;
      }

      a { color: #a5b4fc; text-decoration: underline; }
      a:hover { color: #c4b5fd; }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="top">
        <div>
          <h1>Ma collection (Locale)</h1>
          <div class="meta" id="meta">—</div>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn secondary" href="index.html">← Retour packs</a>
          <button class="btn secondary" id="clear">Clear collection</button>
        </div>
      </div>

      <div id="content"></div>
    </div>

    <script>
      const VS_COLLECTION_KEY = "vaultspin_collection_v1";

      function getCollection() {
        try { return JSON.parse(localStorage.getItem(VS_COLLECTION_KEY) || "[]"); }
        catch { return []; }
      }
      function setCollection(arr) {
        localStorage.setItem(VS_COLLECTION_KEY, JSON.stringify(arr));
      }

      function rarityClass(rk) {
        if (rk === "COMMON") return "common";
        if (rk === "RARE") return "rare";
        if (rk === "ULTRA") return "ultra";
        if (rk === "LEGENDARY") return "legendary";
        return "common";
      }

      function render() {
        const arr = getCollection();
        const meta = document.getElementById("meta");
        const content = document.getElementById("content");

        if (meta) meta.textContent = `${arr.length} carte(s) — stockée(s) en localStorage`;

        if (!arr.length) {
          content.innerHTML = `
            <div class="empty">
              Aucune carte pour l’instant. Ouvre un pack sur <a href="index.html">la page packs</a>.
            </div>
          `;
          return;
        }

        const grid = document.createElement("div");
        grid.className = "grid";

        arr.forEach((c) => {
          const el = document.createElement("div");
          el.className = "card";

          el.innerHTML = `
            <div class="thumb"><img src="${c.img}" alt="card"/></div>
            <div class="row">
              <span class="id">#${c.tokenId}</span>
              <span class="rar ${rarityClass(c.rarityKey)}">${c.rarityLabel}</span>
            </div>
          `;

          grid.appendChild(el);
        });

        content.innerHTML = "";
        content.appendChild(grid);
      }

      document.getElementById("clear").addEventListener("click", () => {
        if (!confirm("Supprimer toute la collection locale ?")) return;
        setCollection([]);
        render();
      });

      render();
    </script>
  </body>
</html>
